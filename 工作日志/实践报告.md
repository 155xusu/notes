 



全日制专业学位研究生
专业实习环节总结报告



学  院    计算机学院        
姓  名    殷康龙            
学  号    ZY1906614         
导  师     吕良双            




北京航空航天大学研究生院
2020年  8月 24 日
 
一、实习目的
深入公司内部，更广泛的接触公司的开发人员。切身地参与到开发团队中，了解如何与团队中的其他人沟通，大家之间通过什么样的方式相互合作共同促进，向其他人学习专业技术和工作方式，从而能与周围人一起成长，成为公司中需要的人才。同时学习大家如何进行高效的沟通，在会议或者协商过程中，如何快速表达自己的意图，同时又理解别人的观点，大家如何通过相互合作完成一个项目，从项目需求的提出、需求开发、本地测试、联调测试、项目上线、报警处理等一系列工作流程的学习。
了解公司部门的构成和职能。了解企业内部行政工作的工作流程，包括绩效考核、日常考勤、资金申请等过程，适应公司的工作环境，从而确立自己在公司中的工作定位，为自己的职业生涯规划起到关键作用。同时了解一个企业的文化魅力，通过领导和同事的交流沟通，发现公司的价值所在，从而对工作和未来有所期待。
将学习到的理论知识应用到实践当中。反过来检验计算机书本上知识的正确性。在学校期间学习了数据库、计算机网络、操作系统等理论知识，还学习了C++、Python、Java等变成语言，积累了大量的编程思想，虽然也做过一些小项目小demo，但是距离企业生产的实际要求还相差甚远。希望在这一次专业实践中，能够尽量将理论知识应用到时间过程中，检验日常学习的效果，加强自己平时学习到的内容。
了解当前的发展前沿。计算机是一个发展迅速的行业，每年每天都会产生一堆新技术，淘汰一堆旧技术，在课本上学到的，可能与社会上技术的版本相差了好几代。需要切身地投入到实际的生产生活中，学习一些新技术、新方法、新思想。从而用最先进的观点武装自己，让自己在后续的就业中更有竞争力。
二、实习内容
2.1 专业实践单位介绍
北京中科金财科技股份有限公司成立于2003年12月,是国内领先的区块链技术与金融科技综合服务商,致力于打造领先的产业互联网科技赋能平台。2012年2月28日公司在深圳证券交易所成功上市。中科金财一直以来为人民银行、银保监会、证监会、银联、银行间交易商协会、支付清算协会及上百家银行及金融机构客户提供金融科技综合服务及转型综合服务，是国内领先的金融科技综合服务商和数据中心综合服务商。
2.2 专业实践项目介绍
本次专业实践的项目为“基于微服务系统的电子钱包”项目。本项目主要涉及三个领域，包括区块链技术、数字金融和开放银行。
基于区块链技术搭建中科金链平台，由北京中科金财科技股份有限公司研发的企业级区块链基础平台。为客户提供区块链基础平台及应用开发服务降低客户使用区块链的技术门槛，为客户提供区块链技术产品、解决方案、业务软件开发等全流程服务。通过不断的突破创新，累积了大量的区块链核心技术，并与多领域的重要龙头合作伙伴携手共建“区块链平台+金融/监管/民生领域”的区块链生态系统。中科金财致力于成为领先的产业互联网科技赋能平台，公司面向政府监管部门、金融机构、产业互联网、工业互联网用户提供基于区块链BaaS（区块链即服务）平台与多方安全计算平台的技术服务，以解决防篡改、隐私保护、可追溯等痛点。始于金融科技，放眼价值互联。未来，中科金财将以区块链BAAS服务平台、多方安全计算平台、区块链公共服务平台为基础，继续以科技服务金融和监管，携手合作伙伴，深耕行业场景，帮助产业客户实现从IT到DT到AT的技术升级
数字金融平台。帮助传统银行进行数字化转型，数字化时代市场需求在变化，数字化将成为银行业下阶段的最不可忽视的战略重点。金融服务模式在不断革新，传统银行的数字化转型势在必行，数字化将成为银行业下阶段的最不可忽视的战略重点。数字化风暴给银行业带来了机遇，同时也带来了新的挑战。
开放银行系统。银行把自己的金融服务，通过安全的Open API或SDK等技术开放给高频场景和客户。其本质是银行放弃单一的成本较高的直销获客方式，转为与线上线下高频大流量场景方合作，通过输出账户、支付、存款、交易、融资产品、投资产品等金融服务能力，以更快速、更高频、更低成本获得客户，并提供极其便捷的场景化、个性化的金融服务。
该项目涉及多个领域多种技术的融合。包括前后端的开发人员、隐私计算与区块链的专业技术人员、与大型银行公司合作的对接人员，项目开发人员的规模超过百人，是大型的创新立项项目，旨在打造一套全平台的，融合银行、企业的数字生态系统。为传统的银行提供数字化赋能。
2.3 实践工作岗位介绍
本次实践的岗位为电子钱包组后端开发人员。该工作岗位涉及到与前后端的沟通，融合数据存储和业务处理两部分内容，访问其他企业提供的远端接口，根据用户的请求完成业务逻辑处理，根据前端的展示需求提供数据访问服务。
主要的工作内容，基于微服务框架，构建后端的微服务系统。首先根据业务需求，与前端对接，提供必要的数据访问和业务处理接口。然后与其他企业对接，从开发的接口中，获取其他企业的对接数据，对数据进行初步处理，并存储到后端数据库中。然后根据用户的支付下单需求和退款等业务需求，完成相应的业务逻辑处理。
2.4 Spring框架应用实践
本项目后端的主要开发框架，是基于java的Spring框架。Spring框架主要依赖与两个重要的特性——控制反转和依赖注入。控制反转（IOC），即控制权的转移，将我们创建对象的方式反转了,以前对象的创建是由我们开发人员自己维护,包括依赖关系也是自己注入。使用了spring之后，对象的创建以及依赖关系可以由spring完成创建以及注入，反转控制就是反转了对象的创建方式，从我们自己创建反转给了程序创建。依赖注入（DI）spring这个容器中，替你管理着一系列的类，前提是你需要将这些类交给spring容器进行管理，然后在你需要的时候，不是自己去定义，而是直接向spring容器索取，当spring容器知道你的需求之后，就会去它所管理的组件中进行查找，然后直接给你所需要的组件。
基于这两种思想实现的Spring容器有许多好处，如降低组件之间的耦合度，实现软件各层之间的解耦。可以使容器提供众多服务如事务管理消息服务处理等等。当我们使用容器管理事务时，开发人员就不需要手工 控制事务，也不需要处理复杂的事务传播。容器提供单例模式支持，开发人员不需要自己编写实现代码。容器提供了AOP技术，利用它很容易实现如权限拦截，运行期监控等功能。容器提供众多的辅佐类，使这些类可以加快应用的开发。Spring作为一个容器，可以管理对象的生命周期、对象与对象之间的依赖关系。可以通过配置文件，来定义对象，以及设置与其他对象的依赖关系。
在实践过程中，使用静态工厂方法创建了一系列的java Bean对象，通过配置XML文件，将对象注入到具体执行的类当中。Spring框架本身还保证了事务的原子性、一致性、隔离性和持久性。Spring boot是Spring体系下，为了快速创建应用而提供的一套脚手架服务，用于快速创建网络应用。Spring AOP框架基于代理模式，同时运行时可配置；AOP框架主要针对模块之间的交叉关注点进行模块化。通过maven工具简单的创建Spring boot应用，通过starter中整合了该场景下各种可能用到的依赖，只需要在Maven中引入starter依赖，框架就能自动扫描到要加载的信息并启动相应的默认配置。Spring MVC 是 Spring 提供的一个基于 MVC 设计模式的轻量级 Web 开发框架，其本身就是 Spring 框架的一部分，可以与 Spring 无缝集成，性能方面具有先天的优越性，是当今业界最主流的 Web 开发框架之一。Spring boot创建一款开源框架，它提供了 spring-boot-starter-web来为 Web 开发予以支持。spring-boot-starter-web为我们提供了嵌入的Servlet容器以及Spring MVC的依赖，并为Spring MVC提供了大量自动配置，可以适用于大多数 Web 开发场景。
为了使Spring boot应用能够快速加载配置，使用YAML文件快速配置Spring项目的依赖。使用YAML作为属性配置文件，YAML语法使用缩进表示层级关系，对大小写敏感。YAML支持对象、数组、字面量三种数据结构。同时Spring boot通过大量的注解实现配置的绑定和容器的注入。
在部署过程中主要使用了WebJars，WebJars可以将Web前端资源（JS，CSS 等）打成一个个的Jar包，然后将这些Jar包部署到Maven中央仓库中进行统一管理，当 Spring Boot项目中需要引入Web前端资源时，只需将所需资源的pom依赖导入到项目中即可。
在开发前端的时候，开发框架主要使用了基于nodejs的vuejs框架，用于获取并渲染数据到前端页面。使用bootstrap作为模板，构建基于H5的应用页面，能够动态自适应页面的大小，并将页面扁平化。
2.5 数据存储技术
在开发过程中主要使用MySQL关系型数据库存储数据，使用Redis非关系型数据库做数据缓存，使用Spring-MyBatis框架，封装对数据库的增删查改操作。数据操作主要包括两部分，第一部分是从远程接口请求数据，存储到关系型数据库中。第二部分是从关系型数据库中访问数据，返回前端，渲染到页面上。对于第二部分需要Redis做一级缓存，为了加快数据访问。
为了能够进行事务管理，MySQL的数据库引擎选择InnoDB。所有的表都保存在同一个数据文件中，InnoDB表的大小只受限于操作系统文件的大小，一般为2GB。需要更多的内存和存储，会在内存中简历专用的缓冲池用于高速缓冲数据和索引。索引和数据紧密捆绑，索引无压缩，所以体积相对比较大。InnoDB引擎支持外键和索引，支持事务管理和数据库锁。能够保证数据库事务的原子性、一致性等，在三级锁协议下能够保证数据库的串行化访问。MySQL的数据类型主要包括三种：数值类型、字符串类型和时间日期类型。在设计过程中要特别注意，符合BNF范式，保证子段不可分，且不存在冗余。
主要在数据库中创建了各种各样的表格，包括商品表（商品名称、类型、编号、价格、供应商、数量等子段）、订单表（订单类型、订单编号、父订单编号、支付单号、创建时间、当前状态、用户、商户、税费等子段）、用户表（用户名称、用户编号、平台金额、用户身份等子段）。每一张表格代表多个独立的实体，多个表格之间通过外键进行关联。
为了加快数据的访问速度，在MySQL的数据表上创建了各种类型的索引。MySQL中常用的索引结构有：B+树索引和哈希索引两种。目前建表用的B+树索引就是BTREE索引。在MySQL中，MyISAM和InnoDB两种存储引擎都不支持哈希索引。只有HEAP/MEMORY引擎才能显示支持哈希索引。所以主要包括五种类型：唯一索引、主键索引、外键索引、普通索引，复合索引。通过建立索引能够有效的加快访问速度。B+树是一个平衡的多叉树，从根节点到每个叶子节点的高度差值不超过1，而且同层级的节点间有指针相互链接。在B+树上的常规检索，从根节点到叶子节点的搜索效率基本相当，不会出现大幅波动，而且基于索引的顺序扫描时，也可以利用双向指针快速左右移动，效率非常高MySQL 由连接池、SQL 接口、解析器、优化器、缓存、存储引擎等组成，可以分为三层，即 MySQL Server 层、存储引擎层和文件系统层。MySQL Server 层又包括连接层和 SQL 层。
使用Spring访问数据库的时候，需要手动创建SQL语句，或者通过Spring提供的jdbc链接数据库，根据orm映射规则，自己封装数据库语句。我们在开发的时候，选择了比较流行的MyBatis框架。MyBatis是一个半自动化的 ORM 框架，支持定制化 SQL、存储过程以及高级映射。支持将数据库查出的数据映射到POJO实体类上，而实体到数据库的映射则需要我们自己编写SQL语句实现，相较于Hibernate 这种完全自动化的框架，Mybatis 更加灵活，我们可以根据自身的需求编写sql语句来实现复杂的数据库操作。支持普通 SQL 查询,存储过程和高级映射的优秀持久层框架。它消除 了几乎所有的JDBC代码和参数的手工设置以及结果集的检索。MyBatis使用简单的XML或注解用于配置和原始映射,将接口和 Java 的 POJOs映射成数据库中的记录。利用动态语句的特性，方便快速的拼接访问数据库的SQL语句。
Mybatis的功能架构分为三层。API接口层：提供给外部使用的接口API，开发人员通过这些本地API来操纵数据库。接口层一接收到调用请求就会调用数据处理层来完成具体的数据处理。数据处理层：负责具体的SQL查找、SQL解析、SQL执行和执行结果映射处理等。它主要的目的是根据调用的请求完成一次数据库操作。基础支撑层：负责最基础的功能支撑，包括连接管理、事务管理、配置加载和缓存处理，这些都是共用的东西，将他们抽取出来作为最基础的组件。为上层的数据处理层提供最基础的支撑。
我们首先需要在Spring框架中导入Mybatis的配置在Spring Boot的配置文件中进行配置，指定mapper.xml的位置、实体类的位置、是否开启驼峰命名法等。然后配置数据库链接的信息。在MySQL数据库中创建了多张表，并创建了mapper文件，建立sql语句到java环境的映射，用来访问MySQL数据库。然后在配置文件中注册数据库访问xml，在Spring的java文件中引用该配置，完成对数据库的访问。
为了提升用户的体验，加快前端的访问速度，解决MySQL数据库存储和访问的瓶颈。使用Redis数据库提供了以及数据缓存。使得系统能够快速相应用户的数据存储和访问操作。redis是一个开源的、使用C语言编写的、支持网络交互的、可基于内存也可持久化的Key-Value数据库。与MySQL关系型数据库不同，它没有持久话的文件，是暂存在内存中的数据库，没有固定的表结构。Redis数据库作为缓存数据库有许多优势。Redis主要用于以下两种场景：高性能场景，需要执行耗时特别久，且结果不频繁变动的 SQL，就特别适合将运行结果放入Redis缓存。后面的请求就去缓存中读取，使得请求能够迅速响应；高并发场景，在大并发的情况下，所有的请求直接访问数据库，数据库会出现连接异常。这个时候，就需要使用 Redis 做一个缓冲操作，让请求先访问到 Redis，然后逐步同步到关系型数据库中。
Redis支持丰富的数据类型，包括string，list，set，sorted set，hash。主要由以下几种底层数据类型实现：动态字符串类型，保存字符串的长度、字符串的每个元、buf 数组中未使用的字节数量，能够动态的增加长度，并减少重新分配内存的次数；双向链表，通过多个节点结构就可以组成双向链表。字典又称为符号表或者关联数组、或映射，是一种用于保存键值对的抽象数据结构。跳跃表是一种有序数据结构，它通过在每个节点中维持多个指向其它节点的指针，从而达到快速访问节点的目的。
Redis支持主从同步。数据可以从主服务器向任意数量的从服务器上同步，从服务器可以是关联其他从服务器的主服务器。这使得Redis可执行单层树复制。存盘可以有意无意的对数据进行写操作。由于完全实现了发布/订阅机制，使得从数据库在任何地方同步树时，可订阅一个频道并接收主服务器完整的消息发布记录。同步对读取操作的可扩展性和数据冗余很有帮助。Redis以内存作为数据存储介质，所以读写数据的效率极高，远远超过数据库。以设置和获取一个256字节字符串为例，它的读取速度可高达110000次/s，写速度高达81000次/s。它速度快，因为数据存在内存中，类似于HashMap，HashMap的优势就是查找和操作的时间复杂度都是O(1)。支持事务，操作都是原子性。可用于缓存、消息、设置过期时间。Redis利用队列技术将并发访问变为串行访问，消除了传统数据库串行控制的开销。为了解决读写分离模型的缺陷，可以将数据分片模型应用进来。可以将每个节点看成都是独立的master，然后通过业务实现数据分片。
Redis有多种持久化方法，RDB方式在指定的时间间隔内，将内存中的数据集快照写入到磁盘。AOF方式以日志的形式记录服务器处理的每一个操作，服务器启动之初，读取文件，重新构建数据库。
Redis的底层架构决定了它的性能优势。内部实现采用epoll机制和简单的事件框架。epoll中的读、写、关闭、连接都转化成了事件，然后利用epoll的多路复用特性， 降低IO过程的延迟。
2.6 基于gRpc的微服务技术
在开发后期，为了能够更好的适应项目夸大的需求，公司制定新的发展计划，基于grpc重构后端框架，将后端拆解为多个独立的微服务，并行建设发展。很好地保证了各个模块的独立性，提高了开发效率，同时又由于微服务的弹性部署方式，使得系统的鲁棒性增强，服务的效率增高。
微服务一种软件开发技术，面向服务的体系结构（SOA）架构样式的一种变体，将应用程序构造为一组松散耦合的服务。在微服务体系结构中，服务是细粒度的，协议是轻量级的。使得应用系统具备快速响应、灵活部署、敏捷交付、持续演进的特性成为可能。微服务是由以单一应用程序构成的小服务，自己拥有自己的行程与轻量化处理，服务依业务功能设计，以全自动的方式部署，同时服务会使用最小的规模的集中管理能力，服务可以用不同的编程语言与数据库等组件实现 。
微服务架构与敏捷研发流程一脉相承。微服务是将一个完整的系统分割成若干微小的、具备独立性的功能单元，每个功能单元是可以具备一个实际意义的小功能集。各个功能单元之间尽量是解耦或松耦合的，可以实现独立开发而不依赖其他功能单元。而敏捷保证微服务架构能够更好地适应需求的变化，保持团队的高效沟通，敏捷利用小型工作增量、频繁迭代与原型设计等手段，可以使我们摆脱大规模单体软件开发的风险。微服务架构更多地从技术的角度提升开发和运维的效率，而敏捷方法论贯穿了软件工程的整个流程，它重视流程、沟通、协作。可以说，敏捷在管理流程上是对微服务架构落地的有益补充和保障。微服务的开发大致遵循DevOps的流程和原则，一个软件从零开始到最终交付，大概包括以下几个阶段：规划、编码、构建、测试、发布、部署和维护。DevOps是一组过程、方法与系统的统称，用于促进开发、技术运营和质量保障（QA）部门之间的沟通、协作与整合。通过自动化流程来使得软件整体过程更加快捷和可靠。用于实现敏捷开发的目标。
我们研究了微服务主要面临的问题，主要是故障的排查，通过多方考虑建立了微服务的故障排查系统。首先是微服务的监控系统（指标接口），实时监控流量的运转，尽量能够快速的发现存在的潜在问题，包括一些设定的报警规则，如网络流量异常、内存占用异常、数据库链接异常、响应延迟异常、qps导致某个节点不堪重负等。让各个组件提供报告自己当前状态的接口（metrics接口），这个接口输出的数据格式应该是一致的。然后部署一个指标采集器组件，定时从这些接口获取并保持组件状态，同时提供查询服务。最后还需要一个UI，从指标采集器查询各项指标，绘制监控界面或者根据阈值发出告警。我们最终使用RedisExporter和MySQLExporter，这两个组件分别提供了Redis缓存和MySQL数据库的指标接口。微服务则根据各个服务的业务逻辑实现自定义的指标接口。然后采用Prometheus作为指标采集器，Grafana配置监控界面和邮件告警。
然后是通过链路跟踪系统，定位问题出现的位置。使用Zipkin工具，实现链路的跟踪过程，实现每一个节点的日志收集。为了能够快速的实现日志分析，使用ELK日志分析组件。包括一个日志搜索引擎、日志收集存储器和UI组件。
为了能够控制微服务的访问权限，进行服务治理，搭建了一套网关系统。在调用者和被调用者中间加一层网关，每次调用时进行权限校验。另外，网关也可以作为一个提供服务接口文档的平台。能够进行各个微服务的接口管理，通过页面访问和调试微服务。
由于微服务的扩充速度比较快速，最终搭建了一个微服务的注册和发现系统。每当有新的微服务或者微服务的某个新节点出现的时候，完成服务信息发布、存活检测、客户端负载均衡等任务。各个应用服务在启动时自动将自己注册到服务发现服务上。并且应用服务启动后会实时（定期）从服务发现服务同步各个应用服务的地址列表到本地。服务发现服务也会定期检查应用服务的健康状态，去掉不健康的实例地址。服务发现系统还会进行服务之间的负载均衡，防止某一个服务流量过大，称为微服务链路上的流量瓶颈。
在实现微服务系统的时候，还考虑了大量的其他安全性可靠性内容。包括建立链路上的熔断机制，当多次访问一个服务失败时，应熔断，标记该服务已停止工作，直接返回错误。直至该服务恢复正常后再重新建立连接。建立了微服务的多级测试系统，服务本地的单元测试，整个服务的测试，端到端测试（覆盖这个服务调用链的测试）。
在构建微服务系统的核心关键技术是gRpc。gRPC是由Google公司开源的一款高性能的远程过程调用(RPC)框架，可以在任何环境下运行。该框架提供了负载均衡，跟踪，智能监控，身份验证等功能，可以实现系统间的高效连接。另外，在分布式系统中，gRpc框架也有有广泛应用，实现移动端、浏览器等和服务器的连接。gRPC支持多种语言的实现，因此gRPC支持客户端与服务器在多种语言环境中部署运行和互相调用。gRPC使用ProtoBuf来定义服务，ProtoBuf是由Google开发的一种数据序列化协议（类似于XML、JSON、hessian）。ProtoBuf能够将数据进行序列化，并广泛应用在数据存储、通信协议等方面。压缩和传输效率高，语法简单，表达力强。
gRPC 的协议设计上使用了HTTP2。HTTP2 提供了连接多路复用、双向流、服务器推送、请求优先级、首部压缩等机制。可以节省带宽、降低TCP链接次数、节省CPU，帮助移动设备延长电池寿命等。gRPC主流分布式方案有以下三个etcd, zookeeper, consul，最终选择使用consul实现服务的注册与负载均衡的实现。
我们通过proto文件定义了数据结构和服务接口。可以通过流模式实现服务器和客户端的调用。集成了TLS验证方法，用于识别客户端和服务器，增强通信的安全性。使用SSL/TLS协议对通信连接进行安全加密，是通过非对称加密的方式来实现的。在加密过程中：客户端想要向服务器发起链接，首先会先向服务端请求要加密的公钥。获取到公钥后客户端使用公钥将信息进行加密，服务端接收到加密信息，使用私钥对信息进行解密并进行其他后续处理，完成整个信道加密并实现数据传输的过程。客户端调用服务时，客户端gRPC库使用协议缓冲区，并编组(marshal)远程过程调用，该调用随后通过HTTP2来发送。在服务器端，请求解组(un-marshalled)，使用协议缓冲区执行相应的过程调用。响应遵循从服务器到客户端的类似的执行流程。
2.7 支付与退款逻辑处理
作为电子钱包财经部分的核心业务，其最大的困难点在于业务场景的理解和负责业务需求的实现，技术上的难点通过之前的分析已经实现了。
首先最大的难点是建立后端的订单子系统，实现后端订单的数据流图。业务方可能会产生多种类型的订单，例如在购物的时候，会生成shop单、商户单、商品单，退款的时候根据退款创建的时间不同，可能产生各种类型的退款单，通过区分是否在售后内或者超售后，是否满足优质用户的急速退款条件，订单是否已经分账，产生不同类型的退款单。在财经部分，根据业务方的需求，建立财经部分的订单系统，该系统主要融合了业务方订单和支付方订单。业务方订单包括shop单、sku单、商品单等，财经部分订单包括四种主要的类型，商品单、支付单、分账单、退分账单、补贴单、推补贴单、退款单等。退款中会生成退款单包括多种类型，如退款子单、急速退款单、退分账单、退补贴单、退税单等。由于支付场景负责，各种订单的准确性必须要有保证。
财经部分最重要的是对金额和流水的保证。建立了从上到下的对账系统，通过流水信息、数据库信息、日志信息等，进行不间断的对账，保证了交易金额的准确性。杜绝发生严重的金融风险。同时增强开发人员的金融管控意识。防止出现资金安全问题。在技术上，使用GO语言重构了后端的微服务，包括一系列配套的微服务工具的应用。如上一节提到的微服务的技术选型：服务注册与发现机制（consul）、敏捷开发流程（devops）、远程调用方式（thrift）、服务监控平台（Grafana）、数据分析平台（Hive）、链路系统跟踪平台、服务网关（Gateway）等。实现一系列微服务开发、部署、运维任务。
在担保交易系统中，总的业务流可以分为四个部分：支付、分账、退款、提现。当用户付款后（自有支付、第三方支付），不能立即存到商家的账户中，需要暂存到商家的待结算户中，防止出现资金安全问题。当用户点击确认收款后，资金从商家的待结算户，分账到商家账户和其他分账方的账户（达人带货分账、平台营销分账等），其中还涉及到平台的营销问题。当用户发起退款是，会根据不同的情况，走完全不同的退款流程，主要包括普通退款、分账前退款、分账后退款、超售后退款和急速退款。其中每一种业务都被划分为一个独立的微服务，可能部署在不同的虚拟机上，存在大量远程调用过程。
当时负责支付营销预计算和分账后退款两个业务，涉及担保退款、退款请求、财经核心微服务，整个服务链包括十几个业务，我负责其中的三个。担保退款业务负责接收来自其他应用的退款请求，查询数据库中的订单，校验请求的准确性，同时通过幂等校验对重复的请求进行处理。退款请求业务，接收担保退款微服务的请求，对请求进一步校验，根据订单状态、支付状态、业务方的需求将退款业务划分为不同的退款方式（急速退款、普通退款、分账后退款、超售后退款等），然后执行不同的退款逻辑。每一种退款都实现了统一的接口，需要校验大量的请求参数和订单内容，保证请求和订单的一致性，需要调用电商接口，计算每一个分账方的分账金额，根据分账方的分分钟金额校验账单系统中的分账单，针对每一个分账单，生成分账的退款单，然后请求支付核心，将商家待结算户中的金额退给用户。如果已经部分分账，需要将所有分账的金额退到商家现金户，推进分账进程，然后从商家的现金户，将金额退还给支付账户，并将平台补贴金额退回。每次退款过程前，需要事先请求计算支付营销金额，如果保证金额正确才可以进行后续的退款，否则返回退款失败。
三、实习表现
在实习过程中积极主动与他人沟通，学习工作的流程和沟通的技巧，掌握了大量新技术，巩固了原有的知识。获得了导师和领导的一致认可。能够独立完成一个需求的开发，掌握了与他人合作开发的技巧，学会了如何进行联调测试，如何在线上线下环境寻找存在的问题。在遇到问题时，能够提出自己的见解和思考，能够将自己的想法正确的表达给其他人。工作积极主动、高效，学习认真，待人诚恳，实习期间主动加班，学习掌握工作中需要的技术和知识。热爱自己的岗位，工作能力比较强，能跟同事友好相处。在短时间内取得了相对不错的成果。
四、主要成果
实习期间的有效代码量超过十万行。主要完成了以下需求：
电子钱包数据库	使用MySQL构建了电子钱包系统的数据库，符合BNF范式，用来存储从合作方获取的金融数据。
Mybatis数据读写	使用MyBatis访问MySQL数据库，完成了大量的MySQL命令，实现了数据的存储和展示。
Spring Boot电子钱包服务	通过java http请求，获取第三方金融数据，对数据内容进行拆解和校验，并存储到自己的数据库中。
Redis缓存	在系统中添加了Redis缓存，大大提升了系统的性能，数据访问的QPS提升了两倍。
gRpc微服务框架	使用grpc微服务框架，重构后端服务，形成为了更高性能的微服务系统。
支付营销预计算	对支付过程的营销金额进行计算。并在退款的时候进行校验，保证了退款的准确性。
分账后退款	针对分账完成后的退款业务，实现退款的流程，校验退款参数，实现退分账过程。
五、收获体会
在实践期间，我深刻的感受到，企业文化的重要性。整个团队是一个完整的一体的团体，大家有这共同的目标，团结、上进、充满活力。每天大家都笑脸相迎，即使面临巨大的压力，办公室内外依旧能够听到笑声。面对同事，大家总是热情真诚，面对工作上的困难，大家总是互帮互助，直到解决苦难，整个机体和睦相处，气氛很和谐很亲切。领导与下属之间、同事与同事之间非常团结、凝聚，就像一个温馨的大家庭，领导就是这个大家庭的家长，给每个人很大的发挥空间。从他们身上，我体会到什么是爱岗敬业，体会到了劳动的快乐，体会到了什么是求真务实。特别令我感动的是，每当我遇到技术和生活上的困难，需要别人支持我的工作的时候，大家都会很热情的协助我。我对能在这样的单位实习感到荣幸和字号。
通过这次实习，我的个人能力得到飞速的提升。巩固计算机开发的基本知识，又了解了行业的前沿，学到了很多新技术。更多的是，尝试去适应了一个伟大的开发团队，从生活上、从习惯上，开始接触真正创造价值的工作，自己的动手能力有很大的提升。相信自己可以在未来的工作中，能够利用好这次实习的经验，学以致用，能够实现自我的人生价值。






填写《北京航空航天大学全日制专业学位研究生专业实习环节考核表》，并给出考核成绩

全日制专业学位研究生专业实习环节总成绩 =（单位评价平均成绩 + 学院考核成绩）/2，并按优、良、中、及格、不及格五级定级。90以上为优，80-90为良，65-79为中，60-64为及格，60以下为不及格。学院同一年级学生专业实习环节成绩，优的比例不超过15%，中、及格与不及格的比例不少于10%。
学生的<专业实习总结报告>以学号为文件名的word文档由班长收齐电子版提交学院教学部门，成绩符合要求资料齐全者给予三个学分。
截止时间为2021年8月30日，请各单位自行确定学生和导师分组名单以及考核的具体时间和地点
