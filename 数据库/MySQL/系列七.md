系列七高级的查询功能

**[sql]** [view plain](http://blog.csdn.net/estom_yin/article/details/52028845)
[copy](http://blog.csdn.net/estom_yin/article/details/52028845)

1.  \#第三十一课时

2.  \--分组查询GROUP BY

3.  

4.  \--按照用户所属省分进行分组

5.  **SELECT** \* **FROM** cms_user **GROUP** **BY** proId;

6.  

7.  \--按照字段位置进行分组

8.  **SELECT** \* **FROM** cms_user **GROUP** **BY** 7;

9.  

10. \--按照多个字段进行分组

11. **SELECT** F **FROM** cms_user **GROUP** **BY** sex,proId;

12. 

13. \--先写条件，后对满足条件的记录进行分组

14. **SELECT** \* **FROM** cms_user **WHERE** id \> 5 **GROUP** **BY** sex;

15. 

16. 

17. \#第三十二课时

18. \--分组查询配合聚合函数

19. \--配合GROUP_CONCAT()函数进行使用

20. \--查询id，sex，username的详情 按照性别分组

21. \--通过性别分组，分组后得到username的分组详情

22. **SELECT** id, sex, GROUP\_CONCAT(username) **FROM** cms_user **GROUP**
    **BY** sex;

23. 

24. \--查询ProID，性别详情，注册时间详情，用户名详情 按照ProID进行分组

25. **SELECT** proId
    ,GROUP\_CONCAT(username),GROUP_CONCAT(sex),GROUP_CONCAT(regTime) **FROM**
    cms_user **GROUP** **BY** proId;

26. 

27. \--常见的聚合函数

28. COUNT()

29. **MAX**()

30. **MIN**()

31. AVG()

32. SUM()

33. \--查询编号，sex，用户名详情以及组中总人数按照sex分组

34. **SELECT** id,sex,GROUP_CONCAT(username)**AS** user ,COUNT(\*)**AS**
    totalUsers **FROM** cms_user **GROUP** **BY** sex;

35. \--COUNT(字段)不统计NULL值

36. **SELECT** COUNT(id) **AS** totalUsers **FROM** cms_user;

37. 

38. \--查询编号，sex，用户名详情以及组中总人数，组中最大年龄，最小年龄，平均年龄，年龄总和按照sex分组

39. **SELECT** id,sex,GROUP_CONCAT(username),

40. COUNT(\*) **AS** totalUsers,

41. **MAX**(age) **AS** max_age,

42. **MIN**(age) **AS** min_age,

43. AVG(age) **AS** avg_age,

44. SUM(age) **AS** sum_age

45. **FROM** cms_user **GROUP** **BY** sex;

46. 

47. 

48. \--配合WITH ROLLUP记录上面所有记录的总和

49. \--在末尾加上WITH ROLLUP 属于聚合统计次字段的总的内容

50. 

51. **SELECT** id,sex,

52. COUNT(\*) **AS** totalUsers,

53. **MAX**(age) **AS** max_age,

54. **MIN**(age) **AS** min_age,

55. AVG(age) **AS** avg_age,

56. SUM(age) **AS** sum_age

57. **FROM** cms_user **GROUP** **BY** sex **WITH** **ROLLUP**;

58. 

59. 

60. \#第三十三课时

61. \--having语句对分组结果进行二次筛选

62. **SELECT** id,sex,GROUP_CONCAT(username),

63. COUNT(\*) **AS** totalUsers,

64. **MAX**(age) **AS** max_age,

65. **MIN**(age) **AS** min_age,

66. AVG(age) **AS** avg_age,

67. SUM(age) **AS** sum_age

68. **FROM** cms_user **GROUP** **BY** sex

69. **HAVING** COUNT(\*)\>2 AND **MAX**(age)\>60;

70. 

71. \#第三十四课时

72. \--ORDER BY 对查询结果进行排序；

73. 

74. \--查询按照id降序进行排列DESC /ASC

75. **SELECT** \* **FROM** cms_user **ORDER** **BY** id **ASC**;

76. 

77. \--按照多个字段进行排序

78. **SELECT** \***FROM** cms_user **ORDER** **BY** age **ASC** ,id **DESC**;

79. 

80. \--实现随机提取记录

81. **ORDER** **BY** RAND();

82. 

83. \#第三十五课时

84. \--通过limit限制显示条数

85. \--LIMIT 显示条数

86. \--LIMIT偏移量，显示条数

87. 

88. \--查询表中前三条记录

89. **SELECT** \* **FROM** cms_user LIMIT 3;

90. 

91. **SELECT** \* **FROM** cms_user **ORDER** **BY** id **DESC** LIMIT 5;

92. 

93. **SELECT** \* **FROM** cms_user LIMTI 10, 5;
